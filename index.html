<!DOCTYPE html>
<html>
<head>
    <title>Control LED ESP32 por Bluetooth</title>
    <style>
        html { font-family: Arial; text-align: center; }
        h1 { color: #070812; padding: 2vh; }
        .button {
            display: inline-block;
            background-color: #b30000;
            border: none;
            border-radius: 4px;
            color: white;
            padding: 26px 40px;
            font-size: 30px;
            cursor: pointer;
            margin: 10px;
        }
        .button2 { background-color: #364cf4; }
    </style>
</head>
<body>
    <h2>Control de LED por Bluetooth</h2>
    <button onclick="connectBLE()">Conectar al ESP32</button>
    <button class="button" onclick="sendCommand('LED_ON')">Encender LED</button>
    <button class="button button2" onclick="sendCommand('LED_OFF')">Apagar LED</button>

    <script>
        let bleDevice, bleServer, bleService, bleCharacteristic;
        const SERVICE_UUID = "BAAD";  // UUID del servicio que contiene la característica de control
        const CHARACTERISTIC_UUID = "F00D"; // UUID de la característica que recibe los comandos

        async function connectBLE() {
            try {
                bleDevice = await navigator.bluetooth.requestDevice({
                    filters: [{ services: [SERVICE_UUID] }],
                    optionalServices: [SERVICE_UUID]
                });

                bleServer = await bleDevice.gatt.connect();
                bleService = await bleServer.getPrimaryService(SERVICE_UUID);
                bleCharacteristic = await bleService.getCharacteristic(CHARACTERISTIC_UUID);

                alert("Conectado al ESP32");
            } catch (error) {
                console.error("Error al conectar:", error);
            }
        }

        async function sendCommand(command) {
            if (!bleCharacteristic) {
                alert("No estás conectado al ESP32");
                return;
            }
            let encoder = new TextEncoder();
            try {
                await bleCharacteristic.writeValue(encoder.encode(command));
                alert("Comando enviado: " + command);
            } catch (error) {
                console.error("Error al enviar comando:", error);
            }
        }
    </script>
</body>
</html>
